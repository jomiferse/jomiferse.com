---
import BaseLayout from "@/layouts/BaseLayout.astro";
import ProjectCard from "@/components/cards/ProjectCard.astro";
import { Icon } from "astro-icon/components";
import { getLocaleFromPath, t } from "@/i18n";
import { getCv } from "@cv";

const locale = getLocaleFromPath(Astro.url.pathname);
const cv = getCv(locale);

const companyProjects = cv.projects?.company ?? [];
const personalProjects = cv.projects?.personal ?? [];

const pageTitle = `${t(locale, "projects.meta.title")} â€“ ${cv.name}`;
const pageDescription = t(locale, "projects.meta.description").replace(
	"{name}",
	cv.name,
);
---

<BaseLayout title={pageTitle} description={pageDescription}>
	<header class="mb-8 space-y-3">
		<h1 class="text-3xl font-bold md:text-4xl">
			{t(locale, "projects.hero.titlePrefix")}{" "}
			<span class="text-purple-600 dark:text-purple-300">
				{t(locale, "projects.hero.titleHighlight")}
			</span>
		</h1>

		<p
			class="max-w-2xl text-sm text-slate-600 md:text-base dark:text-slate-300"
		>
			{t(locale, "projects.hero.subtitle")}
		</p>
	</header>

	<section class="space-y-5">
		<div class="flex items-center gap-3">
			<span
				class="grid h-9 w-9 place-items-center rounded-2xl bg-purple-500/10 text-purple-600 ring-1 ring-purple-500/15 dark:text-purple-300"
			>
				<Icon name="user" class="h-5 w-5" />
			</span>

			<div class="min-w-0">
				<h2 class="text-lg font-semibold text-slate-900 dark:text-zinc-50">
					{t(locale, "projects.sections.personal.title")}
				</h2>
				<p class="text-xs text-slate-600 dark:text-zinc-400">
					{t(locale, "projects.sections.personal.subtitle")}
				</p>
			</div>

			<div class="h-px flex-1 bg-slate-200/80 dark:bg-zinc-800/70"></div>
		</div>

		{
			personalProjects.length ? (
				<div class="grid gap-6 sm:grid-cols-2">
					{personalProjects.map((project) => (
						<ProjectCard project={project} locale={locale} />
					))}
				</div>
			) : (
				<div class="rounded-3xl border border-slate-200/80 bg-white/70 p-6 text-sm text-slate-600 shadow-sm backdrop-blur dark:border-zinc-800/70 dark:bg-zinc-950/40 dark:text-zinc-400">
					{t(locale, "projects.empty.personal")}
				</div>
			)
		}
	</section>

	<div class="my-10 h-px bg-slate-200/80 dark:bg-zinc-800/70"></div>

	<section class="space-y-5">
		<div class="flex items-center gap-3">
			<span
				class="grid h-9 w-9 place-items-center rounded-2xl bg-purple-500/10 text-purple-600 ring-1 ring-purple-500/15 dark:text-purple-300"
			>
				<Icon name="briefcase-business" class="h-5 w-5" />
			</span>

			<div class="min-w-0">
				<h2 class="text-lg font-semibold text-slate-900 dark:text-zinc-50">
					{t(locale, "projects.sections.company.title")}
				</h2>
				<p class="text-xs text-slate-600 dark:text-zinc-400">
					{t(locale, "projects.sections.company.subtitle")}
				</p>
			</div>

			<div class="h-px flex-1 bg-slate-200/80 dark:bg-zinc-800/70"></div>
		</div>

		{
			companyProjects.length ? (
				<div class="grid gap-6 sm:grid-cols-2">
					{companyProjects.map((project) => (
						<ProjectCard project={project} locale={locale} />
					))}
				</div>
			) : (
				<div class="rounded-3xl border border-slate-200/80 bg-white/70 p-6 text-sm text-slate-600 shadow-sm backdrop-blur dark:border-zinc-800/70 dark:bg-zinc-950/40 dark:text-zinc-400">
					{t(locale, "projects.empty.company")}
				</div>
			)
		}
	</section>
</BaseLayout>
