---
import { Icon } from "astro-icon/components";
import { t, type Locale } from "@/i18n";

interface Experience {
	role: string;
	company: string;
	location: string;
	startDate: string;
	endDate: string;
	description: string;
	highlights?: string[];
}

const {
	experience,
	locale = "en",
} = Astro.props as { experience: Experience; locale?: Locale };

const endDate =
	experience.endDate?.toLowerCase() === "present"
		? t(locale, "experienceCard.present")
		: experience.endDate;

const dateLabel = `${experience.startDate} – ${endDate}`;
---

<article
	class="rounded-3xl border border-slate-200 bg-white p-5 shadow-sm transition-all duration-300 hover:border-purple-400/60 hover:shadow-md dark:border-zinc-800 dark:bg-zinc-900/40 dark:hover:border-purple-500/50"
>
	<header class="mb-3">
		<h2 class="text-lg font-semibold text-slate-900 dark:text-zinc-50">
			{experience.role}
		</h2>

		<div class="mt-1 flex flex-wrap items-center gap-x-2 gap-y-1 text-sm">
			<div class="flex items-center gap-2">
				<Icon
					name="building-2"
					class="h-4 w-4 text-slate-400 dark:text-zinc-400"
				/>
				<p class="font-semibold text-purple-600 dark:text-purple-300">
					{experience.company}
				</p>
			</div>

			<span class="text-slate-300 dark:text-zinc-700">•</span>

			<div class="flex items-center gap-2">
				<Icon
					name="map-pin"
					class="h-4 w-4 text-slate-400 dark:text-zinc-400"
				/>
				<p class="text-slate-600 dark:text-zinc-300">{experience.location}</p>
			</div>
		</div>

		<span
			class="mt-3 inline-flex rounded-full border border-purple-200 bg-purple-50 px-3 py-1 text-xs font-semibold text-purple-700 dark:border-purple-500/20 dark:bg-purple-500/10 dark:text-purple-200"
		>
			{dateLabel}
		</span>
	</header>

	{
		experience.description ? (
			<p class="mt-3 text-sm leading-relaxed text-slate-700 dark:text-zinc-200">
				{experience.description}
			</p>
		) : null
	}

	{
		experience.highlights?.length ? (
			<ul class="mt-4 space-y-2 text-sm text-slate-700 dark:text-zinc-200">
				{experience.highlights.map((h) => (
					<li class="flex gap-2">
						<span class="mt-0.5 inline-flex h-5 w-5 items-center justify-center rounded-full bg-purple-50 text-purple-700 dark:bg-purple-500/10 dark:text-purple-200">
							<Icon name="check" class="h-3.5 w-3.5" />
						</span>
						<span>{h}</span>
					</li>
				))}
			</ul>
		) : null
	}
</article>
