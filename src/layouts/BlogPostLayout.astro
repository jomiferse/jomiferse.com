---
import { getLocaleFromPath, type Locale, t } from "@/i18n";
import { Icon } from "astro-icon/components";

interface Frontmatter {
	title: string;
	description?: string;
	date: Date;
	tags?: string[];
	author?: string;
	readingTime?: string;
}

const locale: Locale = getLocaleFromPath(Astro.url.pathname);
const { frontmatter } = Astro.props as { frontmatter: Frontmatter };

const blogPath = `/${locale}/blog`;
const dateLocale = locale === "es" ? "es-ES" : "en-GB";
---

<article class="relative">
	<nav class="mb-8">
		<a
			href={blogPath}
			class="group inline-flex items-center gap-2 rounded-xl border border-slate-200/80 bg-white/70 px-4 py-2 text-sm font-medium text-slate-700 backdrop-blur transition-all hover:border-purple-500/30 hover:bg-purple-50/50 hover:text-purple-700 dark:border-zinc-800 dark:bg-zinc-900/40 dark:text-zinc-300 dark:hover:border-purple-500/30 dark:hover:bg-purple-950/30 dark:hover:text-purple-300"
		>
			<Icon name="arrow-left" class="h-4 w-4 transition-transform group-hover:-translate-x-1" />
			{t(locale, "blog.post.back")}
		</a>
	</nav>

	<header class="relative overflow-hidden rounded-3xl border border-slate-200/80 bg-linear-to-br from-purple-50 via-white to-slate-50 p-5 shadow-sm backdrop-blur sm:p-7 md:p-12 dark:border-zinc-800 dark:from-purple-950/20 dark:via-zinc-900/90 dark:to-zinc-900">
		<div class="pointer-events-none absolute top-0 right-0 -z-10 h-48 w-48 rounded-full bg-purple-500/10 blur-3xl sm:h-64 sm:w-64"></div>
		<div class="pointer-events-none absolute bottom-0 left-0 -z-10 h-40 w-40 rounded-full bg-blue-500/10 blur-3xl sm:h-48 sm:w-48"></div>

		<div class="relative max-w-3xl space-y-5 sm:space-y-6">
			{frontmatter.tags?.length ? (
				<div class="flex flex-wrap gap-2">
					{frontmatter.tags.map((tag) => (
						<span class="inline-flex items-center gap-1.5 rounded-full border border-purple-500/20 bg-purple-500/10 px-3 py-1 text-xs font-semibold text-purple-700 dark:border-purple-500/30 dark:bg-purple-500/20 dark:text-purple-300">
						<Icon name="hash" class="h-3 w-3" />
							{tag}
					</span>
					))}
				</div>
			) : null}

			<h1 class="text-3xl font-extrabold tracking-tight text-slate-900 sm:text-4xl md:text-5xl md:leading-tight dark:text-zinc-50">
				{frontmatter.title}
			</h1>

			{frontmatter.description && (
				<p class="text-base leading-relaxed text-slate-600 sm:text-lg md:text-xl dark:text-zinc-300">
					{frontmatter.description}
				</p>
			)}

			<div class="flex flex-col gap-2 pt-2 text-sm sm:flex-row sm:flex-wrap sm:items-center sm:gap-3">
				<div class="inline-flex w-fit items-center gap-2 rounded-xl border border-slate-200/70 bg-white/60 px-3 py-1.5 text-slate-700 backdrop-blur dark:border-zinc-800 dark:bg-zinc-900/40 dark:text-zinc-300">
					<Icon name="calendar" class="h-4 w-4 text-purple-500" />
					<time datetime={frontmatter.date.toISOString()}>
						{frontmatter.date.toLocaleDateString(dateLocale, {
							year: "numeric",
							month: "long",
							day: "numeric",
						})}
					</time>
				</div>

				{frontmatter.readingTime && (
					<>
						<span class="hidden h-4 w-px bg-slate-300 dark:bg-zinc-700 sm:inline-block"></span>
						<div class="inline-flex w-fit items-center gap-2 rounded-xl border border-slate-200/70 bg-white/60 px-3 py-1.5 text-slate-700 backdrop-blur dark:border-zinc-800 dark:bg-zinc-900/40 dark:text-zinc-300">
							<Icon name="clock" class="h-4 w-4 text-purple-500" />
							<span>{frontmatter.readingTime}</span>
						</div>
					</>
				)}

				{frontmatter.author && (
					<>
						<span class="hidden h-4 w-px bg-slate-300 dark:bg-zinc-700 sm:inline-block"></span>
						<div class="inline-flex w-fit items-center gap-2 rounded-xl border border-slate-200/70 bg-white/60 px-3 py-1.5 text-slate-700 backdrop-blur dark:border-zinc-800 dark:bg-zinc-900/40 dark:text-zinc-300">
							<Icon name="user" class="h-4 w-4 text-purple-500" />
							<span class="truncate">{frontmatter.author}</span>
						</div>
					</>
				)}
			</div>
		</div>
	</header>

	<div class="mx-auto mt-12 max-w-3xl">
		<div class="prose-wrapper">
			<slot />
		</div>

	</div>

	<div class="mx-auto mt-16 max-w-3xl">
		<div class="h-px bg-linear-to-r from-transparent via-slate-200 to-transparent dark:via-zinc-800"></div>

		<footer class="mx-auto mt-12 max-w-3xl rounded-2xl border border-slate-200/80 bg-slate-50/50 p-5 backdrop-blur sm:p-6 dark:border-zinc-800 dark:bg-zinc-900/40">
			<div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
				<p class="text-sm leading-relaxed text-slate-600 dark:text-zinc-400">
					{t(locale, "blog.post.footer")}
				</p>

				<a
					href={blogPath}
					class="inline-flex w-full items-center justify-center gap-2 rounded-xl bg-purple-600 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-purple-700 sm:w-auto"
				>
					{t(locale, "blog.post.backToList")}
					<Icon name="arrow-right" class="h-4 w-4" />
				</a>
			</div>
		</footer>
	</div>
</article>
